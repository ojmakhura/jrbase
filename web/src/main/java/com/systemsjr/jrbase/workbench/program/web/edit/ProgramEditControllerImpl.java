// license-header java merge-point
// Generated by andromda-jsf cartridge (controllers\ControllerImpl.java.vsl)
package com.systemsjr.jrbase.workbench.program.web.edit;

import java.util.Date;
import java.util.Map;

import com.systemsjr.jrbase.JsfUtils;
import com.systemsjr.jrbase.workbench.program.vo.ProgramVO;
import com.systemsjr.jrbase.workbench.program.web.search.SearchProgramsEditFormImpl;

/**
 * @see com.systemsjr.jrbase.workbench.program.web.edit.ProgramEditController
 */
public class ProgramEditControllerImpl
    extends ProgramEditController
{
    /**
     * The serial version UID of this class. Needed for serialization.
     */
    private static final long serialVersionUID = -152857989395661734L;

    /**
     * @see com.systemsjr.jrbase.workbench.program.web.edit.ProgramEditController#doInitialiseEditScreen(ProgramVO programVO)
     */
    @Override
    public void doInitialiseEditScreen(DoInitialiseEditScreenForm form)
    {
    	Map<String, Object> useCaseScope = (Map<String, Object>) JsfUtils.getFlash().get("useCaseScope");

        if(useCaseScope != null && useCaseScope.containsKey("searchProgramsSearchProgramsEditForm"))
        {
        	SearchProgramsEditFormImpl ef = (SearchProgramsEditFormImpl) useCaseScope.get("searchProgramsSearchProgramsEditForm");
        	form.setProgramVO(ef.getProgramVO());
        } 
    }

    /**
     * @see com.systemsjr.jrbase.workbench.program.web.edit.ProgramEditController#doNewProgram()
     */
    @Override
    public void doNewProgram(DoNewProgramForm form)
    {
    	form.setProgramVO(new ProgramVO());
    }

    /**
     * @see com.systemsjr.jrbase.workbench.program.web.edit.ProgramEditController#doRemoveProgram(ProgramVO programVO)
     */
    @Override
    public void doRemoveProgram(DoRemoveProgramForm form)
    {
        getProgramService().removeProgram(form.getProgramVO());
        form.setProgramVO(new ProgramVO());
    }

    /**
     * @see com.systemsjr.jrbase.workbench.program.web.edit.ProgramEditController#doSaveProgram(ProgramVO programVO)
     */
    @Override
    public void doSaveProgram(DoSaveProgramForm form)
    {
        ProgramVO program = form.getProgramVO();
        
        if(program.getId() == null)
        {
        	program.setCreatedAt(new Date());
        	program.setCreatedBy("SYSTEM");
        } else {
        	program.setModifiedAt(new Date());
        	program.setModifiedBy("SYSTEM");
        }
        
        form.setProgramVO(getProgramService().saveProgram(program));
    }

}