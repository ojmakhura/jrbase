// license-header java merge-point
// Generated by andromda-jsf cartridge (controllers\ControllerImpl.java.vsl)
package com.systemsjr.jrbase.workbench.application.web.edit;

import java.util.Date;
import java.util.Map;

import com.systemsjr.jrbase.JsfUtils;
import com.systemsjr.jrbase.workbench.application.vo.ApplicationVO;
import com.systemsjr.jrbase.workbench.application.web.details.ApplicationEditFormImpl;
import com.systemsjr.jrbase.workbench.application.web.search.SearchApplicationsEditFormImpl;

/**
 * @see com.systemsjr.jrbase.workbench.application.web.edit.ApplicationEditController
 */
public class ApplicationEditControllerImpl
    extends ApplicationEditController
{
    /**
     * The serial version UID of this class. Needed for serialization.
     */
    private static final long serialVersionUID = 4803988560586715243L;

    /**
     * @see com.systemsjr.jrbase.workbench.application.web.edit.ApplicationEditController#doInitialiseEditScreen(ApplicationVO applicationVO)
     */
    @Override
    public void doInitialiseEditScreen(DoInitialiseEditScreenForm form)
    {
        Map<String, Object> useCaseScope = (Map<String, Object>) JsfUtils.getFlash().get("useCaseScope");
        
        if(useCaseScope != null) {
        	if(useCaseScope.containsKey("searchApplicationsSearchApplicationsEditForm")) {
	        	SearchApplicationsEditFormImpl ef = (SearchApplicationsEditFormImpl) useCaseScope.get("searchApplicationsSearchApplicationsEditForm");
	        	form.setApplicationVO(ef.getApplicationVO());
        	} else if(useCaseScope.containsKey("applicationDetailsApplicationEditForm")) {
        		
        		ApplicationEditFormImpl df = (ApplicationEditFormImpl) useCaseScope.get("searchApplicationsSearchApplicationsEditForm");
        		form.setApplicationVO(df.getApplicationVO());
        	}
        } 
    }

    /**
     * @see com.systemsjr.jrbase.workbench.application.web.edit.ApplicationEditController#doNewApplication()
     */
    @Override
    public void doNewApplication(DoNewApplicationForm form)
    {
    	form.setApplicationVO(new ApplicationVO());
    }

    /**
     * @see com.systemsjr.jrbase.workbench.application.web.edit.ApplicationEditController#doRemoveApplication(ApplicationVO applicationVO)
     */
    @Override
    public void doRemoveApplication(DoRemoveApplicationForm form)
    {
        getApplicationService().removeApplication(form.getApplicationVO());
        form.setApplicationVO(new ApplicationVO());
    }

    /**
     * @see com.systemsjr.jrbase.workbench.application.web.edit.ApplicationEditController#doSaveAplication(ApplicationVO applicationVO)
     */
    @Override
    public void doSaveAplication(DoSaveAplicationForm form)
    {
        ApplicationVO applicationVO = form.getApplicationVO();
        if(applicationVO.getId() == null)
        {
        	applicationVO.setCreatedAt(new Date());
        	applicationVO.setCreatedBy("SYSTEM");
        } else {
        	applicationVO.setCreatedAt(new Date());
        	applicationVO.setCreatedBy("SYSTEM");
        }
        
        form.setApplicationVO(getApplicationService().saveApplication(applicationVO));
        
    }

}